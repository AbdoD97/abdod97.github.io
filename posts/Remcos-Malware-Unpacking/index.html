<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Remcos Malware Unpacking" /><meta name="author" content="Abdelrahman Eldawi" /><meta property="og:locale" content="en" /><meta name="description" content="Remcos or Remote Control and Surveillance, marketed as a legitimate software by a Germany-based firm Breaking Security for remotely managing Windows systems is now widely used in multiple malicious campaigns by threat actors" /><meta property="og:description" content="Remcos or Remote Control and Surveillance, marketed as a legitimate software by a Germany-based firm Breaking Security for remotely managing Windows systems is now widely used in multiple malicious campaigns by threat actors" /><link rel="canonical" href="https://abdod97.github.io/posts/Remcos-Malware-Unpacking/" /><meta property="og:url" content="https://abdod97.github.io/posts/Remcos-Malware-Unpacking/" /><meta property="og:site_name" content="Abdelrahman Eldawi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-21T05:33:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Remcos Malware Unpacking" /><meta name="twitter:site" content="@twitter_usernam" /><meta name="twitter:creator" content="@Abdelrahman Eldawi" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Abdelrahman Eldawi"},"description":"Remcos or Remote Control and Surveillance, marketed as a legitimate software by a Germany-based firm Breaking Security for remotely managing Windows systems is now widely used in multiple malicious campaigns by threat actors","url":"https://abdod97.github.io/posts/Remcos-Malware-Unpacking/","@type":"BlogPosting","headline":"Remcos Malware Unpacking","dateModified":"2021-09-21T05:33:00+02:00","datePublished":"2021-09-21T05:33:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://abdod97.github.io/posts/Remcos-Malware-Unpacking/"},"@context":"https://schema.org"}</script><title>Remcos Malware Unpacking | Abdelrahman Eldawi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Abdelrahman Eldawi"><meta name="application-name" content="Abdelrahman Eldawi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Abdelrahman Eldawi</a></div><div class="site-subtitle font-italic">Your weekly Reverse Engineering & Malware Analysis blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/abdod97" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_usernam" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['abdelrahman.eldawi97','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Remcos Malware Unpacking</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Remcos Malware Unpacking</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Abdelrahman Eldawi </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 21, 2021, 5:33 AM +0200" >Sep 21<i class="unloaded">2021-09-21T05:33:00+02:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="703 words">3 min read</span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 850 585'%3E%3C/svg%3E" data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/Untitled-3.jpg?raw=true" class="preview-img" alt="Preview Image" width="850" height="585"><p>Remcos or Remote Control and Surveillance, marketed as a legitimate software by a Germany-based firm Breaking Security for remotely managing Windows systems is now widely used in multiple malicious campaigns by threat actors</p><h1 id="sample-info">Sample info</h1><p>Malware family: Remcos RAT</p><p>MD5 hash: 5E9770C2B22B03E5726285900AFAB954</p><h1 id="initial-assessment">Initial assessment</h1><p>At Malware initial assessment using <strong>PE-Studio</strong></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image1.png?raw=true" style="width:6.5in;height:2.78681in" /></p><p>It looks like</p><ul><li><p>This sample is <strong>.NET</strong> sample</p><li><p>This sample contains the magic byte “<strong>MZ</strong>” which means it’s executable</p><li><p>Follows <strong>x32</strong> architecture</p></ul><p>By using <strong>DIE</strong> to analyze each section entropy</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image2.png?raw=true" style="width:5.775in;height:3.43909in" /></p><p>We can conclude that both (.<strong>text</strong> , <strong>.rsrc</strong>) are packed</p><h1 id="analysis">Analysis</h1><p>At first let’s start analyzing this file using <strong>dnspy</strong></p><h2 id="resources"><strong>Resources</strong></h2><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image3.png?raw=true" style="width:3.50049in;height:0.90638in" /></p><p>The first interesting things we can observe from this image are “<strong>Costura</strong>” &amp; “<strong>compressed</strong>” strings!</p><p>So, the first question we should ask ourselves. What is <strong>Costura</strong>?</p><blockquote><p><strong>Costura</strong> is an addon responsible for <strong>Embedding dependencies as resources</strong> on extensible tool for weaving .net assemblies called <strong>Fody,</strong> it is also loads itself with the same technique. After, reaching it’s github project <a href="https://github.com/Fody/Costura">https://github.com/Fody/Costura</a> they also clarified that “<strong>Embedded assemblies are compressed by default</strong>” so “<strong>compressed</strong>” string makes sense now.</p></blockquote><p>By opening “<strong>Campos.properties.resources</strong>” resource we can find</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image4.png?raw=true" style="width:3.16667in;height:0.55208in" /></p><ul><li><p>As we clarified before they are compressed so there is no reason to check them. But as a head up the malware maybe reside in one of them.</p><li><p>So, we should keep track of decompression/decryption and assembly loading functions to be able to unpack it.</p></ul><h2 id="execution-analysis">Execution analysis</h2><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image5.png?raw=true" style="width:4.40872in;height:0.90008in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image6.png?raw=true" style="width:4.98377in;height:1.64181in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image7.png?raw=true" style="width:5.47547in;height:4.05869in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image8.png?raw=true" style="width:6.5in;height:0.62292in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image9.png?raw=true" style="width:5.92791in;height:0.23962in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image10.png?raw=true" style="width:5.09211in;height:1.39179in" /></p><ol><li><p>We can see there that it accesses the resource (<strong>MainWindow.nabexx + MainWindow.nabexx+ MainWindow.nabexx == “XX” +”XX” + “XX” == “XXXXXX”</strong>)</p><li><p>It decrypts it using <strong>AES</strong> algorithm using the resource (<strong>XX</strong>) as key</p><li><p>Then it loads it into the memory</p></ol><p>By extracting the two resources (<strong>XX</strong>, <strong>XXXXXX</strong>) and using this simple python script, we can check what is loaded into the memory.</p><div class="language-python highlighter-rouge"><div class="code-header" data-lang="python"><button><i class="fa-fw far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">Cryptodome.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>

<span class="n">fk</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"XX"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">fk</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">bf</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"XXXXXX"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span>

<span class="nb">file</span> <span class="o">=</span> <span class="n">bf</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">)</span>

<span class="n">new_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"file"</span> <span class="p">,</span> <span class="s">"wb"</span><span class="p">)</span>

<span class="n">new_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="nb">file</span><span class="p">))</span>

<span class="n">new_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><p>Continuing the analysis</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image11.png?raw=true" style="width:6.16667in;height:2.07292in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image12.png?raw=true" style="width:5.4375in;height:4.28125in" /></p><p>It looks like it calls function <strong>X</strong> from <strong>Class1</strong> passing the <strong>loaded assembly</strong> on it</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image13.png?raw=true" style="width:6.5in;height:2.35in" /></p><p>Then it invokes the first method on the loaded assembly.by adding a watch on <strong>X.getMethods()[0]</strong></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image14.png?raw=true" style="width:6.5in;height:0.54653in" /></p><p>It looks like that it invoked Function Void X() on X class on the loaded assembly</p><p>Let’s go through extracted and loaded file analysis</p><h1 id="extracted-file-analysis">Extracted file Analysis</h1><h2 id="file-initial-assessment"><strong>File initial assessment</strong></h2><p>MD5 Hash : 544D12F82787E4453E68906610453093</p><p>using <strong>PE-Studio</strong></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image15.png?raw=true" style="width:6.11667in;height:3.15in" /></p><p>It looks like</p><ul><li><p>This sample is <strong>.NET</strong> sample</p><li><p>This sample contains the magic byte “<strong>MZ</strong>”, file type is <strong>DLL</strong></p><li><p>Follows <strong>x32</strong> architecture</p></ul><p>By using <strong>DIE</strong> to analyze each section entropy</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image16.png?raw=true" style="width:5.35in;height:3.22829in" /></p><p>We can conclude that both .<strong>text</strong> section is packed</p><h1 id="analysis-1">Analysis</h1><p>At first let’s start analyzing this file using <strong>dnspy</strong></p><h2 id="resources-1"><strong>Resources</strong></h2><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image17.png?raw=true" style="width:2.50035in;height:0.7501in" /></p><p>As we have concluded before in the previous sample, it could be using the same technique and there is something packed on these resources and it decrypts it then it is loaded into memory.</p><h2 id="execution-analysis-1">Execution analysis</h2><p>As we have concluded in the previous section, Function <strong>Void X()</strong> in class <strong>X</strong> was executed</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image18.png?raw=true" style="width:4.95833in;height:1.14583in" /></p><p>It passes the executed file to the main function resided in <strong>LOL</strong> class</p><p>**<br /> **</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image19.png?raw=true" style="width:6.5in;height:3.63889in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image20.png?raw=true" style="width:1.78125in;height:0.32292in" /></p><p>For the second time, It it decrypting a resources and loading it them to the memory, But life is too short to trace both unpacking functions .so, We are going to replicate this code snippet into VSCode and extract both files by writing them to disk after decryption</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image21.png?raw=true" style="width:6.5in;height:2.51319in" /></p><h1 id="analyzing-second-file">Analyzing Second file</h1><h2 id="file-initial-assessment-1"><strong>File initial assessment</strong></h2><p>MD5 hash: 06BD2C0097E3CFC03B530BA1391846E3</p><p>using <strong>PE-Studio</strong></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image22.png?raw=true" style="width:6.5in;height:3.86667in" /></p><p>It looks like</p><ul><li><p>This sample contains the magic byte “<strong>MZ</strong>”, file type is <strong>DLL</strong></p><li><p>Follows <strong>x32</strong> architecture</p></ul><p>By using <strong>DIE</strong> to</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image23.png?raw=true" style="width:6.5in;height:1.15833in" /></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image24.png?raw=true" style="width:4.84524in;height:2.81604in" /></p><p>It looks like</p><ul><li><p>It’s <strong>.NET</strong> sample</p><li><p>This file is not packed</p></ul><h1 id="analysis-2">Analysis</h1><p>At first let’s start analyzing this file using <strong>dnspy</strong></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image25.png?raw=true" style="width:6.5in;height:2.96597in" /></p><p>By checking the main function there, it looks that this DLL is loaded before the actual malware unpacking, to check for active antiviruses and use it to avoid original malware detection</p><h1 id="analyzing-third-file">Analyzing third file</h1><h2 id="file-initial-assessment-2"><strong>File initial assessment</strong></h2><p>MD5 hash: 5987997662571356AE78251EA3F44C5E</p><p>using <strong>PE-Studio</strong></p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image26.png?raw=true" style="width:6.5in;height:4.64028in" /></p><p>It looks like</p><ul><li><p>This sample is <strong>C++</strong> sample</p><li><p>This sample contains the magic byte “<strong>MZ</strong>”, and it’s executable</p><li><p>Follows <strong>x32</strong> architecture</p></ul><p>By using <strong>DIE</strong> to analyze each section entropy</p><p><img data-proofer-ignore data-src="https://github.com/AbdoD97/abdod97.github.io/blob/master/_posts/media/image27.png?raw=true" style="width:4.93452in;height:3.01238in" /></p><p>Then finally this is the unpacked malware</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/malware-unpacking/'>malware-unpacking</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/malware-unpacking/" class="post-tag no-text-decoration" >malware-unpacking</a> <a href="/tags/unpacking/" class="post-tag no-text-decoration" >unpacking</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Remcos Malware Unpacking - Abdelrahman Eldawi&url=https://abdod97.github.io/posts/Remcos-Malware-Unpacking/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Remcos Malware Unpacking - Abdelrahman Eldawi&u=https://abdod97.github.io/posts/Remcos-Malware-Unpacking/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Remcos Malware Unpacking - Abdelrahman Eldawi&url=https://abdod97.github.io/posts/Remcos-Malware-Unpacking/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/FlawedAmmyy-Rat/">FlawedAmmyy Rat</a><li><a href="/posts/PoetRAT-Report/">PoetRAT</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/malware-unpacking/">malware-unpacking</a> <a class="post-tag" href="/tags/unpacking/">unpacking</a> <a class="post-tag" href="/tags/dropper/">dropper</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/obfuscated-macro/">obfuscated-macro</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/rat/">rat</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FlawedAmmyy-Rat/"><div class="card-body"> <span class="timeago small" >Oct 23<i class="unloaded">2021-10-23T14:33:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FlawedAmmyy Rat</h3><div class="text-muted small"><p> FlawedAmmyy is a remote access Trojan (RAT) which is based on leaked Ammyy Admin software. Ammyy Admin is a popular remote access tool used by businesses and consumers to handle remote control and ...</p></div></div></a></div><div class="card"> <a href="/posts/PoetRAT-Report/"><div class="card-body"> <span class="timeago small" >Sep 25<i class="unloaded">2021-09-25T18:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PoetRAT</h3><div class="text-muted small"><p> Python RAT uses COVID-19 document lures to target Azerbaijan public and private sectors. Azerbaijan government and energy sector likely targeted by an unknown actor. From the energy sector, the a...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/PoetRAT-Report/" class="btn btn-outline-primary" prompt="Newer"><p>PoetRAT</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="">abdelrahman eldawi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/malware-unpacking/">malware unpacking</a> <a class="post-tag" href="/tags/unpacking/">unpacking</a> <a class="post-tag" href="/tags/dropper/">dropper</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/obfuscated-macro/">obfuscated macro</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/rat/">rat</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://abdod97.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
